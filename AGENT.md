# ã€Šè³­å ´ï¼šå­¸è¡“å¤§äº¨ã€‹Dynamic Agent Workflow (v1.0)

æ­¤å·¥ä½œæµç¨‹æ ¸å¿ƒï¼š**ç¢ºä¿ã€ŒéŠæˆ²å¼•æ“Žã€èˆ‡ã€Œå‹•æ…‹æ’ä»¶ã€çš„æ•¸æ“šå¥‘ç´„ (Contract) æ°¸ä¸ä¸­æ–·ï¼Œä¸¦åš´æ ¼åŸ·è¡Œã€Œ80/20 è²¡å‹™é‚è¼¯ã€çš„æ ¡æº–ã€‚**

## ðŸ›‘ æ•¸æ“šå®Œæ•´æ€§èˆ‡æª”æ¡ˆç¯„åœ (SCOPE & INTEGRITY)

1.  **æª”æ¡ˆæ”¯æŒç¯„åœï¼š**
    *   **Android Core:** `.kt` (Compose/Room/Retrofit), `.xml`, `.gradle.kts`
    *   **Data Plugin:** `config.json`, `bundle.json`, `metadata.json`
    *   **Documentation:** `log.md`, `todo.md`, `api_standard.md` (JSON æ ¼å¼æ¨™æº–)
2.  **`log.md` æ­·å²ä¿è­·ï¼š** çµ•å°ç¦æ­¢è¦†è“‹èˆŠç´€éŒ„ï¼ŒæŽ¡ç”¨ **é ‚éƒ¨æ’å…¥ (Prepending)**ã€‚
3.  **`todo.md` ç²¾æº–æ¸…ç†ï¼š** åŸ·è¡Œå‰åƒ…åˆªé™¤å·²æ¨™è¨˜ `[x]` çš„é …ç›®ï¼Œåš´ç¦åœ¨æœªå®Œæˆæ™‚åˆªé™¤ä»»å‹™ã€‚
4.  **è²¡å‹™é‚è¼¯éŽ–å®šï¼š** ä»»ä½•æ¶‰åŠ `balance` æˆ– `debt` çš„ä»£ç¢¼ä¿®æ”¹ï¼Œå¿…é ˆå¼·åˆ¶æª¢æŸ¥ã€Œé‚„å‚µæ‰£æ¬¾é‚è¼¯ (Debt Deduction Logic)ã€ã€‚

---

## ðŸ” Android èˆ‡å‹•æ…‹æ’ä»¶é™¤éŒ¯æ©Ÿåˆ¶ (Self-Debugging)

### **ç•¶å·¥å…·å›žå ± "Nothing to report" ä½†é‚è¼¯ç•°å¸¸æ™‚ï¼Œç«‹å³å•Ÿå‹•ã€Œæ‰‹å‹•æ·±è¹²æ¨¡å¼ã€ï¼š**
1.  **JSON å¥‘ç´„æ ¡é©—ï¼š** æ‰‹å‹•è®€å– `Question` Entity é¡žåˆ¥èˆ‡é›²ç«¯ `bundle.json` çš„æ¬„ä½å®šç¾©ã€‚æª¢æŸ¥ `a` (æ­£ç¢ºç­”æ¡ˆç´¢å¼•) æ˜¯å¦è¶…å‡º `options` é™£åˆ—é•·åº¦ã€‚
2.  **Room é·ç§»æª¢æŸ¥ï¼š** è‹¥ä¿®æ”¹äº†è³‡æ–™åº«æ¬„ä½ï¼Œå¿…é ˆæª¢æŸ¥ `RoomDatabase` çš„ç‰ˆæœ¬è™Ÿèˆ‡ Migration é‚è¼¯ã€‚
3.  **UI ç‹€æ…‹å›žæº¯ï¼š** æª¢æŸ¥ Jetpack Compose çš„ `State` æˆ– `CollectAsStateWithLifecycle` æ˜¯å¦å›  Recomposition å°Žè‡´é¤˜é¡é¡¯ç¤ºå»¶é²ã€‚
4.  **åœ–ç‰‡è·¯å¾‘åµæŸ¥ï¼š** æ‰‹å‹•é©—è­‰ `image_url` æ˜¯å¦ç¬¦åˆ `Coil` åŠ è¼‰åº«çš„è¦æ ¼ã€‚

---

## é‚è¼¯åˆ¤æ–·æµç¨‹ (Logic Flow)

### 1. Mode A: è¦åŠƒèˆ‡ç¶­è­· (Architect & Plan)
*   **ç†±æ›´æ–°æª¢æŸ¥ï¼š** ç¢ºèªä¿®æ”¹æ˜¯å¦å½±éŸ¿ `config.json` çš„ç‰ˆæœ¬åˆ¤å®šé‚è¼¯ã€‚
*   **æ“´å……è©•ä¼°ï¼š** è‹¥è¦æ–°å¢žã€Œé¡žç¾¤ã€(å¦‚ï¼šé«˜ä¸­éƒ¨)ï¼Œå¿…é ˆç¢ºèª `bundle_id` çš„å”¯ä¸€æ€§ã€‚

### 2. Mode B: é–‹ç™¼ã€é™¤éŒ¯èˆ‡åŸ·è¡Œ (Develop, Debug & Execute)

#### **Phase 1: ç’°å¢ƒæ ¡æº–**
1.  è®€å– `todo.md` æ¸…ç†èˆŠé …ã€‚
2.  **è·¯å¾‘æª¢æŸ¥ï¼š** ç¢ºä¿æ˜¯åœ¨ `app/src/main/java/com/academic/tycoon/` ä¸‹çš„æ“ä½œã€‚

#### **Phase 2: ä»»å‹™è·¯å¾‘åˆ¤å®š (CRITICAL)**

*   **è·¯å¾‘ Aï¼šä¿®å¾© Bug (é‚è¼¯æˆ–æ•¸æ“šå´©æ½°)**
    *   **è‹¥ Linter æ²’å ±éŒ¯ï¼š** ç«‹å³æ‰‹å‹•è¿½è¹¤ `FinanceViewModel` ä¸­çš„é‡‘é¡æµå‘ã€‚
    *   **é©—è­‰é‚„å‚µæ¯”ä¾‹ï¼š** ç¢ºä¿ `reward * 0.8` çš„é‹ç®—æ²’æœ‰ç™¼ç”Ÿæµ®é»žæ•¸æ¨å…¥èª¤å·® (å»ºè­°ä½¿ç”¨ `Long` æˆ– `BigDecimal`)ã€‚
*   **è·¯å¾‘ Bï¼šæ–°å¢žåŠŸèƒ½/UI é‡æ§‹/JSON æ›´æ–°**
    *   **âŒ ä¸ç­‰å¾…éŒ¯èª¤å ±å‘Šï¼š** ç›´æŽ¥åŸ·è¡Œ UI åˆ»ç•«æˆ– JSON çµæ§‹èª¿æ•´ã€‚
    *   **âœ… ä¾è³´æª¢æŸ¥ï¼š** æ–°å¢žåšå¼ˆåŠŸèƒ½æ™‚ï¼Œç¢ºä¿ `Random` æ•¸å€¼ç”¢ç”Ÿå™¨ä¸æœƒè¢« Compose é‡ç¹ªé‡è¤‡è§¸ç™¼ã€‚

#### **Phase 3: å°è£çµæ¡ˆ**
1.  **æ›´æ–° `log.md` (é ‚éƒ¨æ’å…¥)ï¼š**
    *   æ ¼å¼ï¼š`### v[ç‰ˆæœ¬è™Ÿ]: [è®Šæ›´æ¨™é¡Œ]`
    *   **æ ¸å¿ƒè¨˜éŒ„ï¼š** ç´€éŒ„å° Room Schemaã€é‚„å‚µç®—æ³•ã€æˆ–é¡Œåº« JSON æ ¼å¼çš„ä»»ä½•ç•°å‹•ã€‚
2.  **æ›´æ–° `todo.md`ï¼š** æ‰“å‹¾å®Œæˆã€‚

---

## ðŸ¤– å°ˆå±¬é™¤éŒ¯æŒ‡ä»¤ï¼šé‡å°ã€Šå­¸è¡“å¤§äº¨ã€‹
**å¦‚æžœ `inspect_code` æ²’å ±éŒ¯ï¼Œä½†çŽ©å®¶ã€Œè³‡ç”¢è¨ˆç®—ä¸å°ã€ï¼ŒAgent å¿…é ˆï¼š**
1.  **è®€å–è³‡ç”¢æ ¸å¿ƒï¼š** è®€å– `FinanceViewModel.kt` èˆ‡ `UserRepository.kt`ã€‚
2.  **æ¨¡æ“¬é‹ç®—ï¼š** ã€Œæˆ‘ç™¼ç¾ç•¶ `debt` ç‚º 500ï¼Œ`reward` ç‚º 100 æ™‚ï¼Œä»£ç¢¼å¯¦ä½œæœƒå…ˆæ‰£é™¤å‚µå‹™å†è¨ˆç®—é¤˜é¡ï¼Œèˆ‡ 80/20 è¦ç¯„ä¸ç¬¦ã€‚ã€
3.  **å¼·åˆ¶åŸ·è¡Œé‡å¯«ï¼š** åªè¦é‚è¼¯èˆ‡ã€Šå°ˆæ¡ˆè¨ˆç•«æ›¸ã€‹ä¸ç¬¦ï¼Œç„¡è¦–ç·¨è­¯å™¨è­¦å‘Šï¼Œå¼·åˆ¶åŸ·è¡Œ `write_file`ã€‚

---

## ç‹€æ…‹å›žå ±ç¯„æœ¬ (Mode B å®Œç•¢)

> "âœ… **ä»»å‹™åŸ·è¡Œå®Œç•¢ (Academic Tycoon Core)**
>
> 1. **åŸ·è¡Œå…§å®¹ (è·¯å¾‘ A: Bug Fix)**:
     >    - æª”æ¡ˆï¼š`FinanceViewModel.kt`
     >    - è®Šæ›´ï¼šä¿®æ­£äº†é‚„å‚µé‚è¼¯ä¸­çš„å–æ•´å•é¡Œï¼Œç¢ºä¿ 80% æ”¶ç›Šç²¾ç¢ºåŒ¯å…¥å‚µå‹™æ± ã€‚
> 2. **è‡ªæˆ‘æª¢æŸ¥**:
     >    - JSON å…¼å®¹æ€§ï¼šå·²ç¢ºèª API å›žå‚³æ¬„ä½èˆ‡ Local Entity ä¸€è‡´ã€‚
     >    - UI ç‹€æ…‹ï¼šé¤˜é¡æ•¸å­—åœ¨å‚µå‹™ç‹€æ…‹ä¸‹å·²æ­£ç¢ºé¡¯ç¤ºç‚ºæ·±ç´…è‰² (#8B0000)ã€‚
> 3. **æ–‡ä»¶åŒæ­¥**:
     >    - `todo.md`: ä»»å‹™ `[x]`ã€‚
     >    - `log.md`: å·²åœ¨é ‚éƒ¨è¿½åŠ ç´€éŒ„ï¼Œ**ä¿ç•™æ‰€æœ‰æ­·å²è³‡ç”¢é‚è¼¯è®Šå‹•**ã€‚
>
> è«‹æª¢æŸ¥ `app/src/main/...` ä¸‹çš„è®Šå‹•ã€‚"